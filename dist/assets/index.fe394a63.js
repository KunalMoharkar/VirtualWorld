import{P as V,O as _,V as h,Q as g,T as Q,M as p,F as $,G as z,W as Z,B as K,s as J,E as ee,a as w,b as F,c as te,d as q,R as oe,S as ae,e as se,U as ne,f as B,g as re,h as ie,i as de,j as le,k as G,A as ce,l as me,m as he,D as ue,H as pe,n as we,o as fe,p as ge}from"./vendor.6d7cb166.js";const ye=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(a){if(a.ep)return;a.ep=!0;const r=s(a);fetch(a.href,r)}};ye();class Se{camera;model;motion;velocity;position;animationState;location;lookSpeedX;lookSpeedY;constructor({FOV:t,aspect:s,near:c,far:a},r){this.camera=new V(t,s,c,a),this.camera.name="PlayerCam",this.model=new _,this.model.add(this.camera);const l=new _;l.name="PlayerMesh",l.position.y+=.5,this.model.add(l),this.position=new h(0,0,0),this.motion={forward:!1,left:!1,reverse:!1,right:!1,mouseNormalX:0,mouseNormalY:0,mousecapture:!1},this.velocity=0,this.animationState="idle",this.location=r,this.initControls(),this.lookSpeedX=this.lookSpeedY=1e-5}setCameraPosition(t){this.camera.position.copy(t)}addModel(t){this.model.getObjectByName("PlayerMesh")?.add(t)}initControls(){document.addEventListener("keydown",t=>{switch(t.key){case"w":this.motion.forward=!0,this.animationState="accelerating";break;case"a":this.motion.left=!0;break;case"s":this.motion.reverse=!0,this.animationState="decelerating";break;case"d":this.motion.right=!0}}),document.addEventListener("keypress",t=>{switch(t.key){case"c":this.motion.mousecapture=!this.motion.mousecapture,this.motion.mouseNormalX=0,this.motion.mouseNormalY=0}}),document.addEventListener("keyup",t=>{switch(t.key){case"w":this.motion.forward=!1,this.animationState="idle";break;case"a":this.motion.left=!1;break;case"s":this.motion.reverse=!1,this.animationState="idle";break;case"d":this.motion.right=!1;break}}),document.addEventListener("pointermove",t=>{if(this.motion.mousecapture){const s=(t.clientX-window.innerWidth/2)*2-1,c=-((t.clientY-window.innerHeight/2)*2-1);this.motion.mouseNormalX=-s,this.motion.mouseNormalY=c}}),document.addEventListener("touchstart",t=>{this.lookSpeedX=this.lookSpeedY=3e-5})}motionUpdate(){this.motion.forward&&(this.velocity+=.01),this.motion.left&&this.model.rotateY(.02),this.motion.right&&this.model.rotateY(-.02),this.motion.reverse&&(this.velocity-=.01);let t=new g,s=new g;t.setFromAxisAngle(new h(0,1,0),this.motion.mouseNormalX*this.lookSpeedX),s.setFromAxisAngle(new h(1,0,0),this.motion.mouseNormalY*this.lookSpeedY),this.model.applyQuaternion(t),this.camera.applyQuaternion(s)}animate(){const t=this.model.getObjectByName("PlayerMesh");switch(this.animationState){case"accelerating":{const s=new g;s.setFromAxisAngle(new h(1,0,0),-Math.PI/6),t.quaternion.slerp(s,.1);break}case"decelerating":{const s=new g;s.setFromAxisAngle(new h(1,0,0),Math.PI/6),t.quaternion.slerp(s,.1);break}case"idle":{const s=new g;s.setFromAxisAngle(new h(1,0,0),0),t.quaternion.slerp(s,.1);break}}}update(){this.motionUpdate(),this.animate(),this.model.translateZ(-this.velocity),this.velocity*=.8}}var ve="/VirtualWorld/assets/Grass_01.9ac8299f.png",be="/VirtualWorld/assets/Grass_01_Nrm.cfd946ec.png";const Le="res/textures/grass/Grass_01.png",Me="res/textures/grass/Grass_01_Nrm.png",ke="res/models/avatar/source/eve.fbx",xe="res/shaders/sky/sky.frag",Pe="res/shaders/sky/sky.vert",Ee=document.querySelector("#app"),n={time:document.querySelector("#time"),location:document.querySelector("#location"),modal:document.querySelector("#modal"),controls:{w:document.querySelector("#w"),a:document.querySelector("#a"),s:document.querySelector("#s"),d:document.querySelector("#d"),mouseCapture:document.querySelector("#capture")}};function Ae(){n.modal.addEventListener("click",t=>{n.modal.classList.remove("appear-grow")});const e=document.createElement("iframe");e.setAttribute("id","adv-site-iframe"),e.src="https://www.youtube.com/embed/SIOM-RyamcI",e.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",e.allowFullscreen=!0,e.style.width="80%",e.style.height="80%",e.style.margin="auto",n.modal.appendChild(e)}Ae();const T=new B,y=new Q,S=y.load(Le);S.wrapS=p;S.wrapT=p;S.repeat.set(64,64);const v=y.load(Me);v.wrapS=p;v.wrapT=p;v.repeat.set(64,64);const b=y.load(ve);b.wrapT=p;b.wrapS=p;b.repeat.set(50,2);const _e=y.load(be),L=new $,Te=new z,Y=new _,R={trees:"/res/models/trees/",props:"/res/models/props/",buildings:"/res/models/buildings/",mobs:"/res/models/mobs/"},Ne=["BirchTree_1.fbx","BirchTree_2.fbx","CommonTree_3.fbx","CommonTree_4.fbx","Willow_2.fbx"],Ce=["Building1_Large.fbx"],u=new Z({powerPreference:"high-performance"});u.shadowMap.enabled=!0;u.shadowMap.type=K;u.setSize(window.innerWidth,window.innerHeight);u.setPixelRatio(window.devicePixelRatio);u.outputEncoding=J;Ee.appendChild(u.domElement);const M=new ee(u);let f=0;const o=new Se({FOV:60,aspect:window.innerWidth/window.innerHeight,near:.1,far:1e3},"Forest");o.camera.position.set(0,1,0);["mousedown","touchstart"].forEach(e=>{n.controls.w.addEventListener(e,t=>{o.motion.forward=!0,o.animationState="accelerating"}),n.controls.a.addEventListener(e,t=>{o.motion.left=!0}),n.controls.s.addEventListener(e,t=>{o.motion.reverse=!0,o.animationState="decelerating"}),n.controls.d.addEventListener(e,t=>{o.motion.right=!0})});["mouseup","touchend"].forEach(e=>{n.controls.w.addEventListener(e,t=>{o.motion.forward=!1,o.animationState="idle"}),n.controls.a.addEventListener(e,t=>{o.motion.left=!1}),n.controls.s.addEventListener(e,t=>{o.motion.reverse=!1,o.animationState="idle"}),n.controls.d.addEventListener(e,t=>{o.motion.right=!1})});n.controls.mouseCapture.addEventListener("click",e=>{o.motion.mousecapture=!o.motion.mousecapture,n.controls.mouseCapture.innerText="Press C to stop"});document.addEventListener("keypress",e=>{e.key=="c"&&(n.controls.mouseCapture.innerText="Start Mouse Capture")});o.model.castShadow=!1;const Fe=new w(new F(.1,.1,.1,1,1,1),new te({color:16777215})),N=new q(65793,.1);Fe.add(N);o.addModel(N);N.position.set(0,0,0);o.setCameraPosition(new h(0,1.25,2));L.load(ke,e=>{e.rotateY(Math.PI),e.scale.set(.1,.1,.1),o.addModel(e)});const W=new oe(void 0,void 0,void 0,5),i=new ae;i.add(o.model);const qe=new se(i,o.camera);M.addPass(qe);const Be=new ne(new B(window.innerWidth,window.innerHeight),2,.5,.4);M.addPass(Be);if(window.devicePixelRatio<=1){const e=new re(window.innerWidth,window.innerHeight);M.addPass(e)}const X=new Float32Array(4);X.set([0,0,1,1]);const H=new ie({fragmentShader:await fetch(xe).then(e=>e.text()),vertexShader:await fetch(Pe).then(e=>e.text()),uniforms:{time:{value:f},fogDensity:{value:.02},fogColor:{value:X}},side:de,fog:!1}),k=new w(new le(100,40,40),H);k.name="skyball";i.add(k);const Ge=new F(.05,.05,.05,1,1,1),Ye=new G({color:15790320,emissive:16777215});function Re(){const e=new w(Ge,Ye);return e.add(new q(986895,.1)),{model:e,radius:5+Math.random()*5,angularSpeed:2*(Math.random()-.5)*.01,frequency:Math.random()*.01,amplitude:.25*Math.random()}}let I=[];function We(){for(let e=0;e<15;e++){let t=Re();I.push(t),i.add(t.model)}}We();async function Xe(){let e=[],t=[];for(let a of Ne){const r=L.loadAsync(`${R.props}${a}`);t.push(r)}const s=await Te.loadAsync("res/models/props/birch_vibrant_1.glb");e=await Promise.all(t),e.forEach(a=>a.scale.set(.02,.02,.02)),e.push(s.scene);const c=20;for(let a=0;a<c;a++){let r=Math.floor(Math.random()*e.length),l=e[r];l.position.set((Math.random()-.5)*20,-Math.random(),(Math.random()-.5)*20),l.castShadow=!0,l.traverse(A=>{A.castShadow=!0,A instanceof w&&A.geometry.computeVertexNormals()});let C=l.clone();C.rotateY(Math.random()*2*Math.PI),Y.add(C)}return Y}Xe().then(e=>i.add(e));async function He(){const e=await L.loadAsync(`${R.buildings}${Ce[0]}`);e.scale.set(.02,.02,.02),e.position.set(12,0,12),e.lookAt(o.model.position),e.name="library",i.add(e)}He();const m=await L.loadAsync("res/models/mobs/Wave Hip Hop Dance.fbx");m.scale.set(.01,.01,.01);m.position.set(10,0,10);i.add(m);const U=new ce(m),Ie=m.animations,Ue=me.findByName(Ie,"mixamo.com"),O=U.clipAction(Ue);O.loop=1/0;O.play();const Oe=new he(3158112,1);i.add(Oe);const d=new ue(16777215,.2);d.color.setHSL(.8,.3,.2);d.position.set(0,1.75,0);d.position.multiplyScalar(40);i.add(d);d.castShadow=!0;d.shadow.mapSize.width=2048;d.shadow.mapSize.height=2048;const x=40;d.shadow.camera.left=-x;d.shadow.camera.right=x;d.shadow.camera.top=x;d.shadow.camera.bottom=-x;d.shadow.camera.far=3500;d.shadow.bias=-1e-4;const P=new pe(16777215,16777215,.2);P.color.setHSL(.8,.2,.2);P.groundColor.setHSL(.5,1,.75);P.position.set(0,50,0);i.add(P);const E=new w(new we(200,200,256,256),new fe({map:S,normalMap:v,wireframe:!1,fog:!1}));E.rotateX(-Math.PI/2);E.receiveShadow=!0;E.castShadow=!1;i.add(E);const je=new ge(50,2,10,8),De=new G({map:b,normalMap:_e,fog:!1}),j=new w(je,De);i.add(j);j.rotateX(Math.PI/2);document.addEventListener("click",e=>{T.x=e.clientX/window.innerWidth*2-1,T.y=-(e.clientY/window.innerHeight)*2+1,W.setFromCamera(T,o.camera);const t=W.intersectObjects(i.children);t&&console.log(t),t[0].object.name=="Building1_Large"&&n.modal.classList.add("appear-grow"),t[0].object.name=="Guard03_Mesh"&&(n.modal.classList.add("appear-grow"),n.modal.innerText="Welcome to A La Danse")});function Ve(){H.uniforms.time.value=f}function Qe(){k.rotateY(1e-4),k.rotateZ(2e-4),U.update(.01),m.lookAt(o.model.position),console.log(m.position.distanceTo(o.model.position)),m.position.distanceTo(o.model.position)<2&&(n.modal.classList.add("appear-grow"),n.modal.innerText="Welcome to A La Danse",console.log("in bounds"))}function $e(){I.forEach(e=>{e.model.position.set(e.radius*Math.cos(e.angularSpeed*f),.5+e.amplitude*Math.sin(e.frequency*2*Math.PI*f),e.radius*Math.sin(e.angularSpeed*f))})}function ze(){o.update(),Qe(),$e(),Ve()}function D(){M.render(),f+=1,ze(),window.requestAnimationFrame(D)}D();
